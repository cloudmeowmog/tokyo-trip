<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ±äº¬è¦ªå­å¯¶å¯å¤¢ä¹‹æ—…</title>
    <meta name="description" content="6å¤©5å¤œæ±äº¬è¦ªå­è‡ªç”±è¡Œè¡Œç¨‹è¡¨">

    <meta name="theme-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ±äº¬ä¹‹æ—…">
    <meta name="mobile-web-app-capable" content="yes">

    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojNGY0NmU1Ij48cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgcng9IjEyOCIgZmlsbD0iIzRmNDZlNSIvPjxwYXRoIGQ9Ik0zNjggMTI4SDE0NEMxMTcuNSAxMjggOTYgMTQ5LjUgOTYgMTc2VjMzNkM5NiAzNjIuNSAxMTcuNSAzODQgMTQ0IDM4NEgzNjhDMzk0LjUgMzg0IDQxNiAzNjIuNSA0MTYgMzM2VjE3NkM0MTYgMTQ5LjUgMzk0LjUgMTI4IDM2OCAxMjhaIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC4yIi8+PHBhdGggZD0iTTI1NiAxNjBDMjAzLjEgMTYwIDE2MCAyMDMuMSAxNjAgMjU2UzIwMy4xIDM1MiAyNTYgMzUyUzM1MiAzMDguOSAzNTIgMjU2UzMwOC45IDE2MCAyNTYgMTYwWk0yNTYgMzIwQzIyMC43IDMyMCAxOTIgMjkxLjMgMTkyIDI1NlMyMjAuNyAxOTIgMjU2IDE5MlMzMjAgMjIwLjcgMzIwIDI1NlMyOTEuMyAzMjAgMjU2IDMyMFoiIGZpbGw9IndoaXRlIi8+PHBhdGggZD0iTTM4NC42IDE4MC42TDM0OS41IDIxNS43QzM1MS4zIDIyOC41IDM1MiAyNDEuOCAzNTIgMjU2QzM1MiAzMDguOSAzMDguOSAzNTIgMjU2IDM1MkMyNDEuOCAzNTIgMjI4LjUgMzUxLjMgMjE1LjcgMzQ5LjVMMTgwLjYgMzg0LjZDMTgwLjYgMzg0LjYgMjAwIDQwNCAyNTYgNDA0QzMxMiA0MDQgNDAwIDMxNiA0MDAgMjYwQzQwMCAyMDAgMzg0LjYgMTgwLjYgMzg0LjYgMTgwLjZaIiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojNGY0NmU1Ij48cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgcng9IjEyOCIgZmlsbD0iIzRmNDZlNSIvPjxwYXRoIGQ9Ik0zNjggMTI4SDE0NEMxMTcuNSAxMjggOTYgMTQ5LjUgOTYgMTc2VjMzNkM5NiAzNjIuNSAxMTcuNSAzODQgMTQ0IDM4NEgzNjhDMzk0LjUgMzg0IDQxNiAzNjIuNSA0MTYgMzM2VjE3NkM0MTYgMTQ5LjUgMzk0LjUgMTI4IDM2OCAxMjhaIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC4yIi8+PHBhdGggZD0iTTI1NiAxNjBDMjAzLjEgMTYwIDE2MCAyMDMuMSAxNjAgMjU2UzIwMy4xIDM1MiAyNTYgMzUyUzM1MiAzMDguOSAzNTIgMjU2UzMwOC45IDE2MCAyNTYgMTYwWk0yNTYgMzIwQzIyMC43IDMyMCAxOTIgMjkxLjMgMTkyIDI1NlMyMjAuNyAxOTIgMjU2IDE5MlMzMjAgMjIwLjcgMzIwIDI1NlMyOTEuMyAzMjAgMjU2IDMyMFoiIGZpbGw9IndoaXRlIi8+PHBhdGggZD0iTTM4NC42IDE4MC42TDM0OS41IDIxNS43QzM1MS4zIDIyOC41IDM1MiAyNDEuOCAzNTIgMjU2QzM1MiAzMDguOSAzMDguOSAzNTIgMjU2IDM1MkMyNDEuOCAzNTIgMjI4LjUgMzUxLjMgMjE1LjcgMzQ5LjVMMTgwLjYgMzg0LjZDMTgwLjYgMzg0LjYgMjAwIDQwNCAyNTYgNDA0QzMxMiA0MDQgNDAwIDMxNiA0MDAgMjYwQzQwMCAyMDAgMzg0LjYgMTgwLjYgMzg0LjYgMTgwLjZaIiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==">
    
    <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoi5p2x5Lqs6Kaq5a2Q5a6d5Y+v5aSi5LmL5peFIiwic2hvcnRfbmFtZSI6IuaZseS6rOaXhSIsImRlc2NyaXB0aW9uIjoiNiBkYXlzIFRva3lvIHRyaXAiLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2YzZjRmNiIsInRoZW1lX2NvbG9yIjoiIzRmNDZlNSIsImljb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTVMTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhSQmIzazVJTjBnTUNBMU1USWdOVEV5SWlOemRIbHNaRDBpWW1GamEyZHliM1Z1WkMxamIyeHZJancwWmpRMlpUVWlQajV5WldOMElIZHBaSFJvUFRBaU5URXlJaUJvWldSbmFIVDBJakV5T0NJZ2ZtbHNiRDBpSXpSbU5EWmxOU0kvUGp4d1lYUm9JR1E5SWswek5qZ2dNVEl4U0RFME5FTXhNVGN1TlNBeE1qZ2dPVFlnTVRRNU1qVStNemsyVjNnMk16azBJak0yTWlVeU1URTNmak14TnpBdU5TMHpOVFVnTVRNNENVZ3pNellnTXRrMExqVWdNemcwSURReE5pQXpOakl1TlNBMU1UWWdNM00yVmpFM05rTTBNVFlXTVRRNU1qVWdNemswTGpVZ01USTRJRNNMdk1USTRhaUlnWm1sc2JDMDlJbmRvYVhSbElHbHZjR0ZqYVhSNVBTSXdMaklpTzgrY0dGMGFDQmtQU0pOTWpVMklERTJNQ015TURNdU1TQXhOakFnTVRZd0lESXdNeXhHTWpVMklETTFOU3d5TURNdU1TMHpOVElnTWpVMklETTFNaVV6TlRJZ016QTRMakVnM05USWdNVFE1TVM4em1EbzVJREUyTUNBeU5UWWdNVFl3V2t3eU5UWWdTXk13UXlJeU1DYzNJanN4T1RJZ01qa3hMak1nT1RJeUlESTFObE15TWpBdU55QXhPVElnTWpVMklETTVNaVV6TWpBZ01qSXdMakNnM01qQWdNVFE1TVM4eVl6RXlJREUyTnlBek1qQWdaV1p2Y210d1BTSm1hV3RsSWk4K1BHeGhkR2dnWkQwaVRUTTROQzQySURFNU1pNTBNelE1TGpVZ01qRTFMakRnek5URXpJakl5T0M1RklETTFNakl3TVRFNE1qVXlJREkyT2t3eU1UTXhNREU1TGpRZ016QXlPakUySURrek1pdzRNekl6TGprZ016QTJMamRNTVRVd0xqVWdNeXQ1T0RVd0xqWStNemd4T1M0eU1EQWdOVEEwSURJMU5pQTBNRFFnM014eUlEa3dOQ0EwTURBZ016RTJJRFF3TUNBeU5qQWdOREF3SURJd01DQXpPRUXuTWlBeE9EQXVOeUJ6T0RRuU1qQTRMalk2Y0NCbWFXeHNQU0ozYUdsMFpTSXZQand2YzNabklqLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCIsInNpemVzIjoiNTEyeDUxMiJ9XX0=">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f3f4f6; margin: 0; padding: 0; user-select: none; -webkit-user-select: none; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .tap-highlight-transparent { -webkit-tap-highlight-color: transparent; }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        .map-text-shadow { text-shadow: 1px 1px 0 #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff; }
        .metro-station { fill: white; stroke-width: 2; r: 5; }
        
        /* Loading é®ç½©æ¨£å¼ */
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background: #f3f4f6; z-index: 9999; flex-direction: column; transition: opacity 0.5s ease; }
        .spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #4f46e5; animation: spin 1s linear infinite; margin-bottom: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* é¿å… iOS å›å½ˆæ•ˆæœ */
        html, body { overscroll-behavior-y: none; }
    </style>
</head>
<body>

    <div id="loading">
        <div class="spinner"></div>
        <div style="color: #666; font-size: 14px;">æ­£åœ¨è¼‰å…¥è¡Œç¨‹...</div>
    </div>

    <div id="root"></div>

    <script>
        setTimeout(function() {
            var loading = document.getElementById('loading');
            if(loading) loading.style.display = 'none';
        }, 3000);
    </script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // 1. åœ–ç¤ºå…ƒä»¶ (Icons)
        // ==========================================
        const iconStyle = { width: '24px', height: '24px' };
        const MapIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" x2="8" y1="2" y2="18"/><line x1="16" x2="16" y1="6" y2="22"/></svg>;
        const ListIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>;
        const MapPinIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>;
        const TrainIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="16" x="4" y="4" rx="2"/><path d="M4 10h16"/><path d="M12 4v6"/><path d="M8 20v2"/><path d="M16 20v2"/><path d="m9 16 2 2 4-4"/></svg>;
        const CoffeeIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></svg>;
        const HomeIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;
        const BedIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 4v16"/><path d="M2 8h18a2 2 0 0 1 2 2v10"/><path d="M2 17h20"/><path d="M6 8v9"/></svg>;
        const CameraIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>;
        const ShoppingBagIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>;
        const PlaneIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 12h20"/><path d="m13 2-3.5 10"/><path d="m9 22 3.5-10"/><path d="M20.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z"/><path d="M3.5 17a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z"/></svg>;
        const NavigationIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>;
        const GuideIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="16" y2="12"/><line x1="12" x2="12.01" y1="8" y2="8"/></svg>;
        const ExternalLinkIcon = ({className}) => <svg style={{width:'12px', height:'12px'}} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>;
        const CalendarIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/><path d="m9 16 2 2 4-4"/></svg>;
        const TicketIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/></svg>;
        const UploadIcon = ({className}) => <svg style={iconStyle} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>;

        const IconComponent = ({ name, className }) => {
            switch (name) {
                case 'plane': return <PlaneIcon className={className} />;
                case 'train': return <TrainIcon className={className} />;
                case 'bed': return <BedIcon className={className} />;
                case 'camera': return <CameraIcon className={className} />;
                case 'shopping': return <ShoppingBagIcon className={className} />;
                case 'coffee': return <CoffeeIcon className={className} />;
                case 'walk': return <NavigationIcon className={className} />;
                default: return <MapPinIcon className={className} />;
            }
        };

        // ==========================================
        // 2. è³‡æ–™å®šç¾©å€ (Data)
        // ==========================================
        const HOTEL_NAME = "Stayme THE HOTEL Ueno";
        const HOTEL_ADDRESS = "Stayme THE HOTEL Ueno, Higashiueno, Taito City, Tokyo";

        const reservationData = [
            {
                category: "äº¤é€š",
                items: [
                    { name: "äº¬æˆ Skyliner", desc: "å¾€è¿”æˆç”°æ©Ÿå ´ï¼Œæœ€å¿«41åˆ†é˜ã€‚", url: "https://www.keisei.co.jp/keisei/tetudou/skyliner/e-ticket/zht/", tips: "ç·šä¸Šè²·ä¾¿å®œ", urgent: false },
                    { name: "JR æ–°å¹¹ç·š", desc: "å¾€è¼•äº•æ¾¤å¿…å‚™ã€‚", url: "https://www.eki-net.com/zh-CHT/jreast-train-reservation/Top/Index", tips: "1å€‹æœˆå‰é è¨‚", urgent: true }
                ]
            },
            {
                category: "æ™¯é»",
                items: [
                    { name: "SHIBUYA SKY", desc: "æ¾€è°·éœ²å¤©å±•æœ›å°ã€‚", url: "https://www.shibuya-scramble-square.com/sky/ticket/zh_tw/", tips: "4é€±å‰å¿…æ¶", urgent: true },
                    { name: "teamLab Planets", desc: "è±æ´²å…‰å½±å±•ã€‚", url: "https://planets.teamlab.art/tokyo/zh-hant/", tips: "å»ºè­°æå‰1å€‹æœˆ", urgent: true }
                ]
            },
            {
                category: "ç¾é£Ÿ",
                items: [
                    { name: "Pokemon Cafe", desc: "æ—¥æœ¬æ©‹åº—ã€‚", url: "https://www.pokemon-cafe.jp/reservation.html", tips: "31å¤©å‰18:00æ¶", urgent: true },
                    { name: "æŒ½è‚‰èˆ‡ç±³", desc: "æ¸‹è°·åº—ã€‚", url: "https://www.tablecheck.com/shops/hikinikutocome-shibuya/reserve", tips: "é€±äº”æ—©9é»æ¶", urgent: true }
                ]
            }
        ];

        const stationGuides = [
            { id: "narita", name: "æˆç”°æ©Ÿå ´T2", desc: "Skyliner èµ·é»", tips: [{ label: "æ­è»Š", text: "B1 æ¨“å±¤" }, { label: "è³¼ç¥¨", text: "è—è‰²æ«ƒæª¯" }], links: [{ title: "å®˜æ–¹æ§‹å…§åœ– (å®˜ç¶²)", url: "https://www.keisei.co.jp/keisei/tetudou/skyliner/tc/station_map/" }] },
            { id: "ueno_jr", name: "JR ä¸Šé‡ç«™", desc: "å‰å¾€è¼•äº•æ¾¤ã€å¸‚å€ç§»å‹•æ¨ç´", tips: [{ label: "æ–°å¹¹ç·š", text: "èµ°ä¸­å¤®æ”¹æœ­" }, { label: "æœˆå°", text: "åœ°ä¸‹19-22" }], links: [{ title: "JR æ±æ—¥æœ¬æ§‹å…§åœ–", url: "https://www.jreast.co.jp/estation/stations/204.html" }] },
            { id: "ueno_metro", name: "éŠ€åº§ç·š ç¨»è·ç”º", desc: "æœ€è¿‘è»Šç«™", tips: [{ label: "ä½ç½®", text: "åƒ…æ¨“æ¢¯" }, { label: "æ¨™èªŒ", text: "æ©˜è‰² G" }], links: [{ title: "æ±äº¬ Metro æ§‹å…§åœ–", url: "https://www.tokyometro.jp/lang_tcn/station/inaricho/index.html" }] },
            { id: "karuizawa", name: "è¼•äº•æ¾¤ç«™", desc: "Outlet èˆ‡è§€å…‰", tips: [{ label: "Outlet å‡ºå£", text: "æŠµé”å¾Œè«‹å¾€ã€å—å£ã€ç§»å‹•ï¼Œå‡ºå»å°±æ˜¯ Outlet" }, { label: "èˆŠè¼•äº•æ¾¤", text: "è«‹å¾€ã€åŒ—å£ã€ç§»å‹•ï¼Œæ­å·´å£«æˆ–ç§Ÿè…³è¸è»Šéƒ½åœ¨é€™é‚Š" }, { label: "å›ç¨‹", text: "æ–°å¹¹ç·šæ”¹æœ­å£åœ¨ 2Fï¼Œè«‹é ç•™æ™‚é–“è²·ä¾¿ç•¶" }], links: [{ title: "JR æ§‹å…§åœ–", url: "https://www.jreast.co.jp/estation/stations/518.html" }] },
            { id: "shibuya", name: "æ¸‹è°·ç«™", desc: "è¿·å®®èˆ¬çš„è»Šç«™", tips: [{ label: "éŠ€åº§ç·š", text: "éŠ€åº§ç·šä½æ–¼ 3F (Scramble Square)ï¼Œå‡ºç«™å¾Œå¾€ä¸‹èµ°æ‰èƒ½åˆ°åå­—è·¯å£" }, { label: "å…«å…¬æ”¹æœ­", text: "è‹¥è¦çœ‹åå­—è·¯å£/å…«å…¬åƒï¼Œè«‹æ‰¾ JR 1F çš„ã€ãƒãƒå…¬æ”¹æœ­ (Hachiko Gate)ã€" }, { label: "SHIBUYA SKY", text: "å…¥å£åœ¨ Scramble Square å¤§æ¨“å¤–å´ 1F æ­é›»æ¢¯ï¼Œæˆ–å¾éŠ€åº§ç·šæ”¹æœ­æ—é€šé“éå»" }], links: [{ title: "æ±äº¬ Metro ç«‹é«”åœ–", url: "https://www.tokyometro.jp/lang_tcn/station/shibuya/index.html" }] },
            { id: "shinjuku", name: "æ–°å®¿ç«™", desc: "ä¸–ç•Œæœ€ç¹å¿™è»Šç«™", tips: [{ label: "3D è²“åœ¨å“ª", text: "è«‹æ‰¾ã€æ±å£ (East Exit)ã€ï¼Œå‡ºä¾†åˆ°åœ°é¢å»£å ´å¾€å°é¢çœ‹" }, { label: "çµ•å°è¿·è·¯", text: "ä¸è¦åœ¨åœ°ä¸‹äº‚èµ°ï¼Œç›¡å¿«ä¸Šåˆ°åœ°é¢å±¤(1F)ç¢ºèªæ–¹å‘" }, { label: "å“¥å‰æ‹‰", text: "å¾æ±å£å‡ºä¾†ï¼Œæ²¿è‘—æ­Œèˆä¼ç”ºæ–¹å‘èµ°ç´„ 5-8 åˆ†é˜" }], links: [{ title: "JR æ–°å®¿ç«™æ§‹å…§åœ–", url: "https://www.jreast.co.jp/estation/stations/866.html" }] }
        ];

        const itineraryData = [
             { day: 1, date: "4/17 (äº”)", title: "æŠµé”èˆ‡éˆ´èŠ½çš„èµ·é»", events: [ { time: "13:25", title: "æŠµé”æ±äº¬æˆç”°æ©Ÿå ´ (NRT)", desc: "é•·æ¦® BR198 ç¬¬äºŒèˆªå»ˆ", icon: "plane", location: "Narita International Airport Terminal 2", hideRoute: true }, { time: "14:30", title: "æ­ä¹˜ Skyliner", desc: "å‰å¾€å¸‚å€", icon: "train", location: "Keisei Ueno Station", transport: { route: "æˆç”°æ©Ÿå ´ç¬¬2èˆªå»ˆç«™ â†’ äº¬æˆä¸Šé‡ç«™", line: "äº¬æˆ Skyliner (å°è™Ÿåº§)", time: "ç´„ 41 åˆ†é˜" } }, { time: "16:00", title: "é£¯åº— Check-in", desc: "Stayme THE HOTEL Ueno", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "äº¬æˆä¸Šé‡ç«™ â†’ é£¯åº—", line: "è¨ˆç¨‹è»Š (å»ºè­°)", time: "ç´„ 10 åˆ†é˜ (è²»ç”¨ç´„ Â¥1000)" } }, { time: "17:15", title: "å‰å¾€ç¨»è·ç”ºç«™", desc: "å¾é£¯åº—æ­¥è¡Œè‡³æœ€è¿‘åœ°éµç«™", icon: "walk", location: "Inaricho Station", transport: { route: "é£¯åº— â†’ ç¨»è·ç”ºç«™", line: "æ­¥è¡Œ", time: "ç´„ 3-5 åˆ†é˜" } }, { time: "17:30", title: "å¾¡èŒ¶ä¹‹æ°´ è–æ©‹", desc: "éˆ´èŠ½ä¹‹æ—…ç¶“å…¸å ´æ™¯ï¼Œä¸‰éµäº¤æœƒ", icon: "camera", location: "Hijiri-bashi Bridge, Tokyo", transport: { route: "ç¨»è·ç”ºç«™ â†’ ç¥ç”°ç«™ (è½‰è»Š) â†’ å¾¡èŒ¶ä¹‹æ°´ç«™", line: "éŠ€åº§ç·š â†’ JR ä¸­å¤®ç·š(å¿«é€Ÿ)", time: "ç´„ 15 åˆ†é˜" } }, { time: "18:30", title: "ç§‹è‘‰åŸ", desc: "å‹•æ¼«è–åœ°ï¼Œæ™šé¤æ¨è–¦ï¼šè‚‰å±‹æ¨ªä¸", icon: "shopping", location: "Akihabara Station", transport: { route: "å¾¡èŒ¶ä¹‹æ°´ç«™ â†’ ç§‹è‘‰åŸç«™", line: "æ­¥è¡Œ (ä¸‹å¡è·¯)", time: "ç´„ 10 åˆ†é˜" } }, { time: "20:30", title: "è¿”å›é£¯åº—", desc: "ä¼‘æ¯å……é›»", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "ç§‹è‘‰åŸç«™ â†’ ä¸Šé‡ç«™ â†’ é£¯åº—", line: "JR å±±æ‰‹ç·š/æ—¥æ¯”è°·ç·š + æ­¥è¡Œ", time: "ç´„ 20 åˆ†é˜" } } ] },
             { day: 2, date: "4/18 (å…­)", title: "å°å ´é‹¼å½ˆ & è±æ´² (é€±å…­)", events: [ { time: "08:45", title: "å‰å¾€ç¨»è·ç”ºç«™", desc: "å¾é£¯åº—å‡ºç™¼", icon: "walk", location: "Inaricho Station", transport: { route: "é£¯åº— â†’ ç¨»è·ç”ºç«™", line: "æ­¥è¡Œ", time: "ç´„ 3-5 åˆ†é˜" } }, { time: "09:00", title: "è±æ´²å¸‚å ´", desc: "é€±å…­äººå¤šï¼Œå»ºè­°æ—©åˆ°ï¼å£½å¸æ—©åˆé¤", icon: "coffee", location: "Toyosu Market", transport: { route: "ç¨»è·ç”ºç«™ â†’ éŠ€åº§ç«™ (è½‰è»Š) â†’ è±æ´²ç«™", line: "éŠ€åº§ç·š â†’ æœ‰æ¨‚ç”ºç·š", time: "ç´„ 30 åˆ†é˜" } }, { time: "11:30", title: "å‰å¾€å°å ´", desc: "æ­ä¹˜ç™¾åˆæµ·é·—è™Ÿ", icon: "train", location: "Daiba Station", transport: { route: "è±æ´²ç«™ â†’ å°å ´ç«™", line: "ç™¾åˆæµ·é·—è™Ÿ (Yurikamome)", time: "ç´„ 20 åˆ†é˜" } }, { time: "13:00", title: "ç¨è§’ç¸é‹¼å½ˆ", desc: "DiverCity Plazaï¼Œçœ‹è®Šèº«ç§€", icon: "camera", location: "Unicorn Gundam Statue" }, { time: "15:30", title: "teamLab Planets", desc: "éœ€é ç´„ï¼Œèµ¤è…³é«”é©—", icon: "camera", location: "teamLab Planets TOKYO", transport: { route: "å°å ´ç«™ â†’ æ–°è±æ´²ç«™", line: "ç™¾åˆæµ·é·—è™Ÿ", time: "ç´„ 23 åˆ†é˜" } }, { time: "18:00", title: "æ™šé¤ï¼šKua'Aina", desc: "å°å ´å¤å¨å¤·æ¼¢å ¡", icon: "coffee", location: "Kua Aina Aqua City Odaiba", transport: { route: "æ–°è±æ´²ç«™ â†’ å°å ´ç«™", line: "ç™¾åˆæµ·é·—è™Ÿ", time: "ç´„ 15 åˆ†é˜" } }, { time: "20:00", title: "è¿”å›é£¯åº—", desc: "çµæŸå°å ´è¡Œç¨‹", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "å°å ´ç«™ â†’ æ–°æ©‹ç«™ â†’ ç¨»è·ç”ºç«™", line: "ç™¾åˆæµ·é·—è™Ÿ â†’ éŠ€åº§ç·š", time: "ç´„ 45 åˆ†é˜" } } ] },
             { day: 3, date: "4/19 (æ—¥)", title: "æ·ºè‰èˆ‡æ™´ç©ºå¡”å¯¶å¯å¤¢ (é€±æ—¥)", events: [ { time: "08:30", title: "å‰å¾€ç¨»è·ç”ºç«™", desc: "é€±æ—¥äººå¤šï¼Œå»ºè­°ææ—©å‡ºç™¼", icon: "walk", location: "Inaricho Station", transport: { route: "é£¯åº— â†’ ç¨»è·ç”ºç«™", line: "æ­¥è¡Œ", time: "ç´„ 3-5 åˆ†é˜" } }, { time: "09:00", title: "æ·ºè‰å¯º", desc: "äººæ½®æ“æ“ ï¼å…ˆæ‹é›·é–€ï¼Œè¶10é»å‰äººå°‘", icon: "camera", location: "Senso-ji", transport: { route: "ç¨»è·ç”ºç«™ â†’ æ·ºè‰ç«™", line: "éŠ€åº§ç·š (å…è½‰è»Š)", time: "ç´„ 3 åˆ†é˜" } }, { time: "11:00", title: "éš…ç”°å·æ­¥é“", desc: "æ•£æ­¥éæ²³å»æ™´ç©ºå¡”", icon: "walk", location: "Sumida River Walk", transport: { route: "æ·ºè‰ â†’ æ™´ç©ºå¡”", line: "æ­¥è¡Œ (ç¶“éš…ç”°å·æ­¥é“)", time: "ç´„ 15-20 åˆ†é˜" } }, { time: "12:30", title: "æ™´ç©ºå¡” & å¯¶å¯å¤¢ä¸­å¿ƒ", desc: "é€±æœ«äººæ½®çœ¾å¤šï¼Œ4F PokÃ©mon Center", icon: "shopping", location: "Pokemon Center Skytree Town" }, { time: "17:00", title: "æ™šé¤ï¼šåˆ©ä¹…ç‰›èˆŒ", desc: "æ™´ç©ºå¡”åº—", icon: "coffee", location: "Rikyu Skytree" }, { time: "19:00", title: "è¿”å›é£¯åº—", desc: "æ­ä¹˜åœ°éµè¿”å›", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "æŠ¼ä¸Šç«™(æ™´ç©ºå¡”) â†’ æ·ºè‰ç«™ â†’ ç¨»è·ç”ºç«™", line: "æ·ºè‰ç·š â†’ éŠ€åº§ç·š", time: "ç´„ 20 åˆ†é˜" } } ] },
             { day: 4, date: "4/20 (ä¸€)", title: "è¼•äº•æ¾¤æ–°å¹¹ç·šä¸€æ—¥éŠ", events: [ { time: "09:00", title: "å‰å¾€ JR ä¸Šé‡ç«™", desc: "æº–å‚™æ­ä¹˜æ–°å¹¹ç·š", icon: "walk", location: "Ueno Station", transport: { route: "é£¯åº— â†’ JR ä¸Šé‡ç«™ (å…¥è°·å£)", line: "æ­¥è¡Œ", time: "ç´„ 10 åˆ†é˜" } }, { time: "10:10", title: "æŠµé”è¼•äº•æ¾¤", desc: "å‰å¾€ç‹å­è³¼ç‰©å»£å ´ Outlet", icon: "shopping", location: "Karuizawa Prince Shopping Plaza", transport: { route: "ä¸Šé‡ç«™ â†’ è¼•äº•æ¾¤ç«™", line: "åŒ—é™¸æ–°å¹¹ç·š (Hakutaka/Asama)", time: "ç´„ 60-70 åˆ†é˜" } }, { time: "14:00", title: "èˆŠè¼•äº•æ¾¤éŠ€åº§é€š", desc: "é¨è…³è¸è»Šã€åƒå¸ƒä¸", icon: "camera", location: "Kyu-Karuizawa Ginza Street", transport: { route: "è»Šç«™ â†’ èˆŠè¼•äº•æ¾¤", line: "ç§Ÿè…³è¸è»Š / å·´å£« / æ­¥è¡Œ(20åˆ†)", time: "ç´„ 10-15 åˆ†é˜" } }, { time: "17:30", title: "è¿”å›ä¸Šé‡", desc: "æ­æ–°å¹¹ç·š", icon: "train", location: "Ueno Station", transport: { route: "è¼•äº•æ¾¤ç«™ â†’ ä¸Šé‡ç«™", line: "åŒ—é™¸æ–°å¹¹ç·š", time: "ç´„ 60 åˆ†é˜" } }, { time: "19:00", title: "æ™šé¤ï¼šé´¨ to è”¥", desc: "ä¸Šé‡ååº—", icon: "coffee", location: "Kamo to Negi Ueno" }, { time: "20:00", title: "è¿”å›é£¯åº—", desc: "æ™šé¤å¾Œæ­¥è¡Œå›é£¯åº—", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "ä¸Šé‡ç«™ â†’ é£¯åº—", line: "æ­¥è¡Œ", time: "ç´„ 10 åˆ†é˜" } } ] },
             { day: 5, date: "4/21 (äºŒ)", title: "ç¯‰åœ°ãƒ»æ¸‹è°·ãƒ»æ–°å®¿", events: [ { time: "08:40", title: "å‰å¾€ç¨»è·ç”ºç«™", desc: "å¾é£¯åº—å‡ºç™¼", icon: "walk", location: "Inaricho Station", transport: { route: "é£¯åº— â†’ ç¨»è·ç”ºç«™", line: "æ­¥è¡Œ", time: "ç´„ 3-5 åˆ†é˜" } }, { time: "09:00", title: "ç¯‰åœ°å ´å¤–å¸‚å ´", desc: "é¿é–‹é€±ä¸‰ä¼‘å¸‚ï¼æµ·é®®ä¸¼ã€ç‰å­ç‡’", icon: "coffee", location: "Tsukiji Outer Market", transport: { route: "ç¨»è·ç”ºç«™ â†’ éŠ€åº§ç«™ (è½‰è»Š) â†’ ç¯‰åœ°ç«™", line: "éŠ€åº§ç·š â†’ æ—¥æ¯”è°·ç·š", time: "ç´„ 20 åˆ†é˜" } }, { time: "12:00", title: "æ¸‹è°· PARCO", desc: "6F å¯¶å¯å¤¢ä¸­å¿ƒ(è¶…å¤¢) & ä»»å¤©å ‚", icon: "shopping", location: "Shibuya PARCO", transport: { route: "ç¯‰åœ°ç«™ â†’ éŠ€åº§ç«™ (è½‰è»Š) â†’ æ¸‹è°·ç«™", line: "æ—¥æ¯”è°·ç·š â†’ éŠ€åº§ç·š", time: "ç´„ 25 åˆ†é˜" } }, { time: "15:00", title: "SHIBUYA SKY", desc: "éœ€é ç´„ï¼Œç„¡æ•µç¾æ™¯", icon: "camera", location: "SHIBUYA SKY" }, { time: "17:30", title: "æ–°å®¿ 3D è²“", desc: "æ–°å®¿æ±å£å»£å ´å°é¢", icon: "camera", location: "Cross Shinjuku Vision", transport: { route: "æ¸‹è°·ç«™ â†’ æ–°å®¿ç«™", line: "JR å±±æ‰‹ç·š", time: "ç´„ 7 åˆ†é˜" } }, { time: "18:30", title: "æ­Œèˆä¼ç”ºå“¥å‰æ‹‰", desc: "æ™šé¤æ¨è–¦ï¼šæ•˜æ•˜è‹‘æˆ–éºµå±‹æ­¦è—", icon: "camera", location: "Godzilla Head Shinjuku", transport: { route: "æ–°å®¿ç«™ â†’ ä¸Šé‡ç«™ â†’ é£¯åº—", line: "JR å±±æ‰‹ç·š (ç´„25åˆ†) + æ­¥è¡Œ", time: "ç´„ 40 åˆ†é˜" } }, { time: "20:30", title: "è¿”å›é£¯åº—", desc: "æ–°å®¿è¿”å›", icon: "bed", location: HOTEL_ADDRESS, transport: { route: "æ–°å®¿ç«™ â†’ ç¥ç”°ç«™ â†’ ç¨»è·ç”ºç«™", line: "JR ä¸­å¤®ç·š â†’ éŠ€åº§ç·š", time: "ç´„ 30 åˆ†é˜" } } ] },
             { day: 6, date: "4/22 (ä¸‰)", title: "æœ€å¾Œæ¡è²· & è¿”å°", events: [ { time: "10:00", title: "Check-out & é˜¿ç¾æ©«ä¸", desc: "æ‹‰è‘—è¡Œææˆ–å¯„æ”¾æ«ƒå°ï¼Œæ­¥è¡Œå‰å¾€", icon: "shopping", location: "Ameyoko Shopping Street", transport: { route: "é£¯åº— â†’ é˜¿ç¾æ©«ä¸", line: "æ­¥è¡Œ", time: "ç´„ 10 åˆ†é˜" } }, { time: "11:30", title: "å‰å¾€æ©Ÿå ´", desc: "æ­ä¹˜ Skyliner", icon: "train", location: "Keisei Ueno Station", transport: { route: "äº¬æˆä¸Šé‡ç«™ â†’ æˆç”°æ©Ÿå ´", line: "Skyliner", time: "ç´„ 41 åˆ†é˜" } }, { time: "12:25", title: "æŠµé”æ©Ÿå ´", desc: "æˆç”°ç¬¬äºŒèˆªå»ˆ", icon: "plane", location: "Narita Airport Terminal 2" }, { time: "14:25", title: "èµ·é£›è¿”å°", desc: "é•·æ¦® BR197", icon: "plane", location: "", transport: "" } ] }
        ];

        // --- 4. çµ„ä»¶å®šç¾©å€ ---

        // Custom Map Component with Upload Logic (V3.3 Original Logic)
        const AttractionsMap = () => {
            const [customImage, setCustomImage] = useState(null);
            const fileInputRef = useRef(null);

            // Load from localStorage on mount
            useEffect(() => {
                const savedImage = localStorage.getItem('tokyoTripCustomMap');
                if (savedImage) setCustomImage(savedImage);
            }, []);

            const handleImageUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        const base64String = reader.result;
                        setCustomImage(base64String);
                        try {
                            localStorage.setItem('tokyoTripCustomMap', base64String);
                        } catch (e) {
                            alert("åœ–ç‰‡å¤ªå¤§ï¼Œç„¡æ³•å„²å­˜åˆ°å¿«å–ï¼Œä½†æœ¬æ¬¡ä½¿ç”¨ä»æœ‰æ•ˆã€‚");
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };

            const resetImage = () => {
                setCustomImage(null);
                localStorage.removeItem('tokyoTripCustomMap');
            };

            return (
                <div className="w-full bg-white rounded-xl shadow-md p-4 mb-4">
                    <h3 className="font-bold text-gray-800 mb-2">æˆ‘çš„è¡Œç¨‹åœ°åœ–</h3>
                    
                    {customImage ? (
                        <div className="relative">
                            <img src={customImage} alt="Custom Map" className="w-full h-auto rounded-lg border border-gray-200" />
                            <button 
                                onClick={resetImage}
                                className="absolute top-2 right-2 bg-red-600 text-white text-xs px-2 py-1 rounded shadow opacity-80 hover:opacity-100"
                            >
                                é‡è¨­
                            </button>
                        </div>
                    ) : (
                        <div className="border-2 border-dashed border-gray-300 rounded-xl p-8 flex flex-col items-center justify-center text-center bg-gray-50">
                            <div className="bg-indigo-100 p-3 rounded-full mb-3">
                                <UploadIcon className="w-6 h-6 text-indigo-600" />
                            </div>
                            <p className="text-sm font-bold text-gray-700 mb-1">å°šæœªè¨­å®šåœ°åœ–</p>
                            <p className="text-xs text-gray-500 mb-4">è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œé¸å–æ‚¨ç›¸ç°¿ä¸­çš„<br/>ã€Œæ±äº¬6æ—¥è¦ªå­å†’éšªåœ°åœ–ã€</p>
                            <button 
                                onClick={() => fileInputRef.current.click()}
                                className="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-bold shadow hover:bg-indigo-700 transition-colors"
                            >
                                é¸æ“‡ç…§ç‰‡
                            </button>
                            <input 
                                type="file" 
                                ref={fileInputRef}
                                onChange={handleImageUpload} 
                                accept="image/*" 
                                className="hidden" 
                            />
                        </div>
                    )}
                </div>
            );
        };

        const MetroMap = () => (
            <div className="w-full h-auto bg-gray-900 rounded-xl overflow-hidden shadow-inner border-2 border-gray-700 p-4 relative">
                <h3 className="text-white text-center mb-2 text-sm font-bold">ç²¾ç°¡ç‰ˆè¡Œç¨‹äº¤é€šåœ–</h3>
                <svg viewBox="0 0 400 500" xmlns="http://www.w3.org/2000/svg" className="w-full h-auto">
                    <g transform="translate(10, 10)">
                        <rect width="130" height="70" fill="rgba(0,0,0,0.7)" rx="5" />
                        <line x1="10" y1="15" x2="40" y2="15" stroke="#f97316" strokeWidth="4" /> <text x="50" y="18" fill="white" fontSize="10">éŠ€åº§ç·š (G)</text>
                        <line x1="10" y1="30" x2="40" y2="30" stroke="#84cc16" strokeWidth="4" /> <text x="50" y="33" fill="white" fontSize="10">JR å±±æ‰‹ç·š</text>
                        <line x1="10" y1="45" x2="40" y2="45" stroke="#3b82f6" strokeWidth="4" /> <text x="50" y="48" fill="white" fontSize="10">ç™¾åˆæµ·é·—è™Ÿ</text>
                        <line x1="10" y1="60" x2="40" y2="60" stroke="#ef4444" strokeWidth="4" /> <text x="50" y="63" fill="white" fontSize="10">æ·ºè‰ç·š (A)</text>
                    </g>
                    <rect x="80" y="150" width="240" height="200" rx="30" fill="none" stroke="#84cc16" strokeWidth="8" opacity="0.8" />
                    <path d="M 60 400 L 280 150 L 350 150" fill="none" stroke="#f97316" strokeWidth="6" />
                    <path d="M 280 350 L 300 450 L 380 450" fill="none" stroke="#3b82f6" strokeWidth="6" />
                    <circle cx="290" cy="150" className="metro-station" stroke="#f97316" />
                    <text x="290" y="135" textAnchor="middle" fill="white" fontSize="12" fontWeight="bold">ç¨»è·ç”º(ä½å®¿)</text>
                    <circle cx="260" cy="150" className="metro-station" stroke="#84cc16" />
                    <text x="250" y="170" textAnchor="end" fill="white" fontSize="12">ä¸Šé‡</text>
                    <circle cx="350" cy="150" className="metro-station" stroke="#ef4444" />
                    <text x="350" y="180" textAnchor="middle" fill="white" fontSize="12">æ·ºè‰</text>
                    <circle cx="260" cy="200" className="metro-station" stroke="#84cc16" />
                    <text x="245" y="205" textAnchor="end" fill="white" fontSize="12">ç§‹è‘‰åŸ</text>
                    <circle cx="240" cy="250" className="metro-station" stroke="#84cc16" />
                    <text x="225" y="255" textAnchor="end" fill="white" fontSize="12">æ±äº¬</text>
                    <circle cx="200" cy="350" className="metro-station" stroke="#84cc16" />
                    <text x="190" y="365" textAnchor="end" fill="white" fontSize="12">æ–°æ©‹</text>
                    <text x="240" y="340" textAnchor="start" fill="#3b82f6" fontSize="10">è½‰ä¹˜ç™¾åˆæµ·é·—â†’</text>
                    <circle cx="80" cy="320" className="metro-station" stroke="#84cc16" />
                    <text x="70" y="325" textAnchor="end" fill="white" fontSize="12">æ¸‹è°·</text>
                    <circle cx="80" cy="200" className="metro-station" stroke="#84cc16" />
                    <text x="70" y="205" textAnchor="end" fill="white" fontSize="12">æ–°å®¿</text>
                    <circle cx="340" cy="450" className="metro-station" stroke="#3b82f6" />
                    <text x="340" y="475" textAnchor="middle" fill="white" fontSize="12">å°å ´</text>
                </svg>
            </div>
        );

        const TravelMapContainer = () => {
            const [mapType, setMapType] = useState('attraction');

            return (
                <div className="w-full h-full bg-blue-50/30 overflow-y-auto flex flex-col items-center p-4 pb-24">
                    <div className="bg-white p-2 rounded-xl shadow-md flex gap-2 mb-4 overflow-x-auto max-w-full">
                        <button onClick={() => setMapType('attraction')} className={`px-3 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${mapType === 'attraction' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600'}`}>ğŸ—ºï¸ æ™¯é»åœ°åœ–</button>
                        <button onClick={() => setMapType('metro')} className={`px-3 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${mapType === 'metro' ? 'bg-gray-800 text-white' : 'bg-gray-100 text-gray-600'}`}>ğŸš‡ è·¯ç·šæŒ‡å¼•</button>
                        <button onClick={() => setMapType('full_metro')} className={`px-3 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-colors ${mapType === 'full_metro' ? 'bg-orange-600 text-white' : 'bg-gray-100 text-gray-600'}`}>ğŸ“‘ å®Œæ•´åœ°éµåœ–</button>
                    </div>
                    <div className="w-full max-w-sm flex-1">
                        {mapType === 'attraction' && <AttractionsMap />}
                        {mapType === 'metro' && <MetroMap />}
                        {mapType === 'full_metro' && (
                             <div className="w-full h-auto bg-white rounded-xl overflow-hidden shadow-inner border-2 border-gray-200 p-1">
                                <div className="overflow-auto h-[60vh]">
                                    <img src="https://www.bubu-jp.com/wp-content/uploads/2019/02/73585d315d861d4ec85a304c947ec7c9.jpg" alt="Tokyo Subway Map" className="w-full h-auto min-w-[200%] object-contain" />
                                </div>
                                <p className="text-[10px] text-gray-400 text-center p-2">åœ–ç‰‡ä¾†æºï¼šbubu-jp.com (éœ€ç¶²è·¯è¼‰å…¥)</p>
                             </div>
                        )}
                        {mapType !== 'full_metro' && (
                            <div className="mt-4 bg-white p-4 rounded-xl shadow-sm">
                                <h4 className="font-bold text-gray-700 mb-2 text-sm">ğŸ’¡ åœ°åœ–ä½¿ç”¨å°æ’‡æ­¥</h4>
                                <ul className="text-xs text-gray-500 space-y-1 list-disc list-inside">
                                    {mapType === 'attraction' ? (
                                        <>
                                            <li>é»æ“ŠæŒ‰éˆ•é¸å–ç›¸ç°¿ä¸­çš„ã€Œæ±äº¬6æ—¥è¦ªå­å†’éšªåœ°åœ–ã€ã€‚</li>
                                            <li>åœ°åœ–å°‡è‡ªå‹•å„²å­˜ï¼Œä¸‹æ¬¡é–‹å•Ÿç„¡éœ€é‡æ–°è¼‰å…¥ã€‚</li>
                                        </>
                                    ) : (
                                        <>
                                            <li><span className="text-orange-500 font-bold">æ©˜è‰²éŠ€åº§ç·š</span> æ˜¯æ‚¨å›å®¶çš„è·¯ã€‚</li>
                                            <li>å»å°å ´è¦åœ¨ <span className="font-bold">æ–°æ©‹</span> è½‰ä¹˜ã€‚</li>
                                        </>
                                    )}
                                </ul>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const StationGuide = () => (
            <div className="p-4 space-y-4 animate-fade-in pb-24">
                 <div className="text-center mb-6"><h2 className="text-xl font-bold text-gray-800">è»Šç«™èˆ‡æœˆå°æ”»ç•¥</h2><p className="text-indigo-600 text-sm">è¿·è·¯æ•‘æ˜Ÿ</p></div>
                {stationGuides.map((station) => (
                    <div key={station.id} className="bg-white border border-gray-100 rounded-2xl p-5 shadow-sm">
                        <h3 className="font-bold text-lg text-gray-800 flex items-center gap-2"><span className="w-2 h-6 bg-indigo-500 rounded-full"></span>{station.name}</h3>
                        <p className="text-sm text-gray-500 mb-4 ml-4">{station.desc}</p>
                        <div className="space-y-3 mb-4">{station.tips.map((tip, idx) => (<div key={idx} className="flex gap-3 bg-gray-50 p-3 rounded-lg text-sm"><span className="bg-white text-indigo-600 border border-indigo-100 text-xs font-bold px-2 py-1 h-fit rounded whitespace-nowrap">{tip.label}</span><span className="text-gray-700 leading-relaxed">{tip.text}</span></div>))}</div>
                        {station.links && station.links.length > 0 && (<div className="flex flex-wrap gap-2 mt-2">{station.links.map((link, lIdx) => (<a key={lIdx} href={link.url} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1.5 text-xs font-bold text-indigo-600 bg-indigo-50 hover:bg-indigo-100 px-3 py-2 rounded-full transition-colors no-underline"><ExternalLinkIcon className="w-3 h-3" /> {link.title}</a>))}</div>)}
                    </div>
                ))}
            </div>
        );

        const ReservationPage = () => (
            <div className="p-4 space-y-6 animate-fade-in pb-24">
                <div className="text-center mb-4"><h2 className="text-xl font-bold text-gray-800">é ç´„ç®¡å®¶</h2><p className="text-indigo-600 text-sm">é»æ“ŠæŒ‰éˆ•ç›´é”é ç´„é é¢</p></div>
                {reservationData.map((section, idx) => (
                    <div key={idx}>
                        <h3 className="text-lg font-bold text-gray-700 mb-3 ml-1 flex items-center"><span className="w-1 h-5 bg-indigo-500 mr-2 rounded-full"></span>{section.category}</h3>
                        <div className="space-y-4">
                            {section.items.map((item, itemIdx) => (
                                <div key={itemIdx} className="bg-white border border-gray-100 rounded-2xl p-4 shadow-sm relative overflow-hidden">
                                    {item.urgent && <div className="absolute top-0 right-0 bg-red-100 text-red-600 text-[10px] font-bold px-2 py-1 rounded-bl-lg">éœ€æå‰é ç´„</div>}
                                    <div className="flex justify-between items-start mb-2"><div><h4 className="font-bold text-gray-800 text-base">{item.name}</h4><p className="text-xs text-gray-500 mt-1">{item.desc}</p></div></div>
                                    <div className="bg-orange-50 border border-orange-100 rounded-lg p-2 mb-3"><p className="text-xs text-orange-700 flex items-start gap-1"><span className="shrink-0">ğŸ’¡</span>{item.tips}</p></div>
                                    <a href={item.url} target="_blank" rel="noopener noreferrer" className="w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-bold py-2.5 rounded-xl transition-colors no-underline"><TicketIcon className="w-4 h-4" /> å‰å¾€é ç´„</a>
                                </div>
                            ))}
                        </div>
                    </div>
                ))}
            </div>
        );

        const App = () => {
            const [view, setView] = useState('list');
            const [activeDay, setActiveDay] = useState(0);

            useEffect(() => {
                const loadingEl = document.getElementById('loading');
                if (loadingEl) loadingEl.style.display = 'none';
            }, []);

            const getMapUrl = (query) => `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
            const getDirUrl = (destination, origin) => {
                let url = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(destination)}&travelmode=transit`;
                if (origin) url += `&origin=${encodeURIComponent(origin)}`;
                return url;
            };

            return (
                <div className="max-w-md mx-auto bg-white min-h-screen shadow-2xl overflow-hidden relative pb-24 safe-bottom flex flex-col">
                    <div className="bg-indigo-600 text-white p-5 pt-12 rounded-b-3xl shadow-lg sticky top-0 z-20 flex-shrink-0">
                        <div className="flex justify-between items-start">
                            <div><h1 className="text-2xl font-bold">æ±äº¬è¦ªå­ä¹‹æ—…</h1><p className="text-indigo-100 text-sm mt-1">4/17 - 4/22 â€¢ 6å¤©5å¤œ</p></div>
                        </div>
                        <a href={getMapUrl(HOTEL_ADDRESS)} target="_blank" rel="noopener noreferrer" className="mt-4 bg-indigo-700/50 p-3 rounded-xl flex items-center gap-3 backdrop-blur-sm active:scale-95 transition-transform border border-indigo-500/30 text-left">
                            <div className="bg-white p-2 rounded-full text-indigo-600"><HomeIcon className="w-5 h-5" /></div>
                            <div className="flex-1 min-w-0"><p className="text-xs text-indigo-200 uppercase font-semibold">ä½å®¿</p><p className="font-bold text-sm truncate text-white">Stayme THE HOTEL Ueno</p></div>
                            <NavigationIcon className="w-5 h-5 text-indigo-200" />
                        </a>
                    </div>

                    <div className="flex-1 overflow-y-auto hide-scrollbar bg-gray-50">
                        {view === 'list' && (
                            <>
                                <div className="sticky top-0 z-10 bg-white/95 backdrop-blur shadow-sm border-b">
                                    <div className="flex overflow-x-auto hide-scrollbar p-2 gap-2 snap-x">
                                        {itineraryData.map((day, index) => (
                                            <button key={index} onClick={() => setActiveDay(index)} className={`flex-shrink-0 snap-center px-4 py-2 rounded-full text-sm font-bold transition-all ${activeDay === index ? 'bg-indigo-600 text-white shadow-md transform scale-105' : 'bg-gray-100 text-gray-500'}`}>Day {day.day}</button>
                                        ))}
                                    </div>
                                </div>
                                <div className="p-4 space-y-6 animate-fade-in pb-24">
                                    <div className="text-center mb-4"><h2 className="text-xl font-bold text-gray-800">{itineraryData[activeDay].date}</h2><p className="text-indigo-600 font-medium">{itineraryData[activeDay].title}</p></div>
                                    <div className="relative pl-4 space-y-8">
                                        <div className="absolute left-[27px] top-4 bottom-4 w-0.5 bg-gray-200"></div>
                                        {itineraryData[activeDay].events.map((event, idx) => {
                                            let prevLocation;
                                            if (activeDay === 0) {
                                                if (idx === 0) prevLocation = null;
                                                else if (idx === 1) prevLocation = itineraryData[0].events[0].location;
                                                else if (idx === 2) prevLocation = itineraryData[0].events[1].location;
                                                else if (idx === 3) prevLocation = HOTEL_ADDRESS;
                                                else prevLocation = itineraryData[0].events[idx-1].location;
                                            } else {
                                                prevLocation = idx === 0 ? HOTEL_ADDRESS : itineraryData[activeDay].events[idx-1].location;
                                            }
                                            return (
                                                <div key={idx} className="relative flex gap-4 group">
                                                    <div className="relative z-10 flex-shrink-0"><div className="w-12 h-12 rounded-full bg-white border-2 border-indigo-100 shadow-sm flex items-center justify-center text-indigo-500"><IconComponent name={event.icon} className="w-6 h-6" /></div></div>
                                                    <div className="flex-1 bg-white border border-gray-100 rounded-2xl p-4 shadow-sm">
                                                        <span className="bg-indigo-50 text-indigo-700 text-xs font-bold px-2 py-1 rounded-md mb-2 inline-block">{event.time}</span>
                                                        <h3 className="font-bold text-gray-800 text-lg leading-tight mb-1">{event.title}</h3>
                                                        <p className="text-gray-500 text-sm mb-3">{event.desc}</p>
                                                        {event.transport && (
                                                            <div className="mb-3 bg-gray-50 p-2.5 rounded-lg border border-gray-100 text-sm">
                                                                <div className="flex items-start gap-2 mb-1"><TrainIcon className="w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0" /><span className="font-semibold text-gray-700">{event.transport.route}</span></div>
                                                                <div className="text-xs text-gray-500 pl-6">{event.transport.line} â€¢ {event.transport.time}</div>
                                                            </div>
                                                        )}
                                                        {event.location && !event.hideRoute && (
                                                            <div className="flex gap-2 mt-2">
                                                                <a href={getMapUrl(event.location)} target="_blank" className="flex-1 flex items-center justify-center gap-1.5 bg-gray-50 text-gray-700 text-xs font-bold py-2.5 rounded-xl no-underline"><MapPinIcon className="w-3.5 h-3.5" /> åœ°åœ–</a>
                                                                <a href={getDirUrl(event.location, prevLocation)} target="_blank" className="flex-1 flex items-center justify-center gap-1.5 bg-indigo-50 text-indigo-600 text-xs font-bold py-2.5 rounded-xl no-underline"><NavigationIcon className="w-3.5 h-3.5" /> è·¯ç·š</a>
                                                            </div>
                                                        )}
                                                        {event.hideRoute && (
                                                             <div className="flex gap-2 mt-2"><a href={getMapUrl(event.location)} target="_blank" className="flex-1 flex items-center justify-center gap-1.5 bg-gray-50 text-gray-700 text-xs font-bold py-2.5 rounded-xl no-underline"><MapPinIcon className="w-3.5 h-3.5" /> æŸ¥çœ‹ä½ç½®</a></div>
                                                        )}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </>
                        )}
                        {view === 'map' && <TravelMapContainer />}
                        {view === 'guide' && <StationGuide />}
                        {view === 'booking' && <ReservationPage />}
                    </div>

                    <div className="absolute bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-2 py-2 pb-6 safe-bottom flex justify-around items-center z-30 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
                        <button onClick={() => setView('list')} className={`flex flex-col items-center gap-1 p-2 rounded-xl min-w-[64px] transition-all ${view === 'list' ? 'text-indigo-600 bg-indigo-50' : 'text-gray-400'}`}><ListIcon className="w-6 h-6" /><span className="text-[10px] font-bold">è¡Œç¨‹</span></button>
                        <button onClick={() => setView('map')} className={`flex flex-col items-center gap-1 p-2 rounded-xl min-w-[64px] transition-all ${view === 'map' ? 'text-indigo-600 bg-indigo-50' : 'text-gray-400'}`}><MapIcon className="w-6 h-6" /><span className="text-[10px] font-bold">åœ°åœ–</span></button>
                        <button onClick={() => setView('guide')} className={`flex flex-col items-center gap-1 p-2 rounded-xl min-w-[64px] transition-all ${view === 'guide' ? 'text-indigo-600 bg-indigo-50' : 'text-gray-400'}`}><GuideIcon className="w-6 h-6" /><span className="text-[10px] font-bold">è»Šç«™</span></button>
                        <button onClick={() => setView('booking')} className={`flex flex-col items-center gap-1 p-2 rounded-xl min-w-[64px] transition-all ${view === 'booking' ? 'text-indigo-600 bg-indigo-50' : 'text-gray-400'}`}><CalendarIcon className="w-6 h-6" /><span className="text-[10px] font-bold">é ç´„</span></button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        
        setTimeout(() => {
            const loadingEl = document.getElementById('loading');
            if (loadingEl && loadingEl.style.display !== 'none') {
                loadingEl.style.display = 'none';
            }
        }, 3000);
    </script>
</body>
</html>